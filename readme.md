# 🤖 6축 로봇팔 3D 시뮬레이터 (FK & 좌표계 변환)

이 프로젝트는 6축 로봇팔(RB5-850)의 순기구학(Forward Kinematics)과 좌표계 변환을 시뮬레이션하는 Python 스크립트입니다.

사용자가 **관절 각도**(`deg`) 또는 **목표 6D 포즈**(`6d`)를 터미널에서 선택하여 입력하면, 로봇팔의 자세, 카메라의 위치, 목표 객체의 위치를 3D 그래프로 시각화합니다.

-----

## 🚀 주요 기능

  * **객체 지향 설계:** `RobotArm`, `Camera`, `Transform3D` 클래스를 사용하여 코드를 모듈화하고 재사용성을 높였습니다.
  * **DH 파라미터 기반 순기구학 (FK):** `rb5_850_dh.csv` 파일에 정의된 Standard DH 파라미터를 기반으로 로봇의 실제 엔드 이펙터(EE) 포즈를 계산합니다.
  * **좌표계 변환:** 로봇 베이스 좌표계($T_{Base}$)와 카메라 좌표계($T_{Cam}$) 간의 변환을 수행합니다.
  * **양방향 입력 모드:**
    1.  **`deg` 모드 (관절 제어):** 6개의 관절 각도를 입력받아 로봇의 자세를 결정합니다. (FK)
    2.  **`6d` 모드 (작업 공간 제어):** 로봇 베이스 기준 6D (x, y, z, rx, ry, rz) 목표 포즈를 입력받아, 로봇은 'Home' 자세를 유지한 채 해당 목표 지점을 3D 공간에 표시합니다.
  * **3D 시각화:** `matplotlib`을 사용하여 로봇, 카메라, 객체의 3D 위치와 자세(RGB 축)를 직관적으로 보여줍니다.

-----

## ⚙️ 실행 방법

1.  **필요 라이브러리 설치:**

    ```bash
    pip install numpy scipy pandas matplotlib
    ```

2.  **DH 파라미터 생성 (최초 1회 실행):**
    `create_dh_csv.py` 스크립트를 실행하여 로봇팔의 DH 파라미터가 담긴 `rb5_850_dh.csv` 파일을 생성합니다.

    ```bash
    python create_dh_csv.py
    ```

3.  **메인 시뮬레이터 실행:**
    `main.py`를 실행합니다.

    ```bash
    python main.py
    ```

-----

## 🎮 사용자 입력 가이드

`main.py`를 실행하면 터미널에서 입력을 받습니다.

### 1\. 모드 선택

먼저 `deg` 또는 `6d` 모드를 선택하라는 메시지가 나타납니다.

```bash
입력 모드를 선택하세요 ('deg' 또는 '6d'):
```

### 2\. 값 입력

#### 🤖 `deg` 모드 (관절 각도 입력)

로봇팔의 6개 관절(J1\~J6) 각도를 **도(`°`) 단위**로, 쉼표(`,`)로 구분하여 입력합니다.

  * **입력 예시 (Home 자세):**
    ```bash
    'deg' 모드: 6개의 관절 각도를 입력하세요 (예: 0, 0, -90, 0, -90, 0)
    관절 각도 (J1~J6) [deg]: 0, 0, -90, 0, -90, 0
    ```
  * **입력 예시 (DH 기준 수직 자세):**
    ```bash
    관절 각도 (J1~J6) [deg]: 0, 90, 0, -90, 0, 0
    ```
  * **결과:** 3D 그래프에 입력된 각도대로 움직인 로봇팔의 자세가 그려집니다.

#### 🎯 `6d` 모드 (6D 타겟 포즈 입력)

로봇이 도달해야 할 **엔드 이펙터(EE)의 목표 지점**을 **로봇 베이스 좌표계 기준**으로 입력합니다.
`x, y, z` (mm) 위치와 `rx, ry, rz` (도 `°`) 회전 각도를 쉼표(`,`)로 구분하여 입력합니다.

  * **입력 예시:**
    ```bash
    '6d' 모드: EE 타겟 포즈(Base 기준)를 입력하세요
       (x, y, z, rx, ry, rz) (예: 200, 0, 600, 0, -80, 0)
    타겟 포즈 (x,y,z,rx,ry,rz): 200, 0, 600, 0, -80, 0
    ```
  * **결과:**
      * 로봇팔은 기본 자세(`[0, 0, -90, 0, -90, 0]`)를 "유지"한 채로 그려집니다.
      * 3D 그래프에 사용자가 입력한 `(200, 0, 600)` 위치에 \*\*자홍색 별표(`*`)\*\*로 "User Target (6D)"가 표시됩니다.

-----

## 📸 3D 시각화 요소 설명

3D 그래프 창에는 다음과 같은 요소들이 표시됩니다.

  * **World/Base Frame (검정 원점 + 굵은 RGB 축):**
    모든 좌표의 기준이 되는 로봇 베이스의 원점입니다.

  * **Robot Arm (검정 선 + 청록색 EE):**
    `deg` 모드에서 입력한 각도 또는 `6d` 모드의 기본 자세로 서 있는 로봇팔입니다. 엔드 이펙터(EE)는 청록색(Cyan)으로 강조 표시됩니다.

  * **Camera Position (보라색 삼각형 `^`):**
    `main.py`에 설정된 카메라 캘리브레이션 값(`T_base_cam`)에 따라 로봇 베이스로부터 떨어진 카메라의 위치를 나타냅니다.

  * **Camera View Direction (회색 점선):**
    카메라의 Z축, 즉 카메라가 바라보는 시선 방향을 나타냅니다.

  * **Target Object (주황색 네모 `s` 또는 자홍색 별 `*`):**

      * **`deg` 모드 시 (주황색 `s`):** 스크립트 내에 가상으로 설정된 "카메라가 검출한 객체"의 위치를 로봇 베이스 기준으로 변환하여 보여줍니다.
      * **`6d` 모드 시 (자홍색 `*`):** 사용자가 터미널에 입력한 6D 목표 포즈를 보여줍니다.

  * **Axis Color Key (범례 옆 텍스트 상자):**
    모든 좌표계의 RGB 축이 의미하는 방향을 알려줍니다.

      * `Red` = **X축**
      * `Green` = **Y축**
      * `Blue` = **Z축**